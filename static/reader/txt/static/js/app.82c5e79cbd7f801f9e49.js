webpackJsonp([1],{"+nFJ":function(t,e){},"+skl":function(t,e){},DgNL:function(t,e){},F2qi:function(t,e,n){var o=n("mtWM"),i=n("cWHa");e.userConf=function(t,e){this.theme=t,this.themeList=e},e.saveUserConf=function(t,e){path=i.saveConfUrl,console.log("saveUserConf: "+path),o.post(path,e).then(function(e){console.log(e),null==e.data||""==e.data?t.$Message.info("保存成功"):t.$Message.error({duration:3,closable:!0,content:"保存出错: "+e.data})}).catch(function(e){console.log(e),t.$Message.error({duration:3,closable:!0,content:"连接出错: "+e})})},e.getUserConf=function(t){console.log("get user conf: "+i.getConfUrl),o.get(i.getConfUrl).then(function(e){if(200==e.status)if(e.data){var n=e.data;t.theme=n.theme,t.themeList=n.themeList}else t.$Message.info("服务端没有配置");else t.$Message.warning({duration:15,closable:!0,content:"then: 同步服务端配置到本地出错："+e.status})}).catch(function(e){t.$Message.error({duration:15,closable:!0,content:"同步服务端配置到本地失败: "+e})})}},GdVx:function(t,e){},LAvd:function(t,e){},MyDj:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("7+uW"),i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var a=n("VU/8")({name:"App"},i,!1,function(t){n("kdvC")},null,null).exports,s=n("/ocq"),r=n("mvHQ"),l=n.n(r),c=n("woOf"),d=n.n(c),f=n("mtWM"),h=n.n(f),u=n("SELZ"),g=n("Pme0"),p=n("F2qi"),m=n("cWHa"),v={bus:null,getCaptionTitleCur:u.getCaptionTitleCur,ReadPosition:u.ReadPosition,updateReadPosition:u.updateReadPosition,setReadPositionScroll:u.setReadPositionScroll,goCaption:u.goCaption,fetchCaptionContent:u.fetchCaptionContent,fetchCatalogs:u.fetchCatalogs,fetchBookInfo:u.fetchBookInfo,showBookInfoModal:u.showBookInfoModal,downloadBook:u.downloadBook,theme:g.theme,colors:g.colors,fontList:g.fontList,basePageWidth:g.basePageWidth,defaultTheme:g.defaultTheme,darkTheme:g.darkTheme,yelloTheme:g.yelloTheme,greenTheme:g.greenTheme,pinkTheme:g.pinkTheme,themeListItem:g.themeListItem,themeList:g.themeList,userConf:p.userConf,saveUserConf:p.saveUserConf,getUserConf:p.getUserConf,getBookmarkUrl:m.getBookmarkUrl,saveBookmarkUrl:m.saveBookmarkUrl},k={props:["relDir","file","caption","captionTitle","readPosition"],data:function(){return{bookmarks:[]}},created:function(){!function(t){console.log("getBookmarks");var e=v.getBookmarkUrl(t.relDir,t.file);h.a.get(e).then(function(e){e.data&&(t.bookmarks=e.data)}).catch(function(t){console.log("获取书签: "+t)})}(this)},watch:{bookmarks:function(){!function(t){console.log("updateServerBookmarks");var e=v.saveBookmarkUrl(t.relDir,t.file);h.a.post(e,t.bookmarks).then(function(e){""==e.data||null==e.data||t.$Message.error({duration:3,content:"保存书签到服务端失败："+e.data})}).catch(function(e){t.$Message.error({duration:3,content:"保存书签到服务端失败："+e})})}(this)}},methods:{clickBookmark:function(t){var e,n;"newMark"==t?(e=this,n=new v.ReadPosition(e.file),v.updateReadPosition(e,n),e.bookmarks.push(n)):function(t,e){for(var n=void 0,o=0;o<t.bookmarks.length;o++)if(t.bookmarks[o].id==e){n=d()({},t.bookmarks[o]);break}v.bus.$emit("goBookmarkEv",n)}(this,t)},delBookMark:function(t){console.log("delBookMark"),function(t,e){var n=function(t,e){for(var n=0;n<t.length;n++)if(t[n].id==e)return n}(t.bookmarks,e);if(void 0==n)return void t.$Message.error("找不到要删除的书签");if(!t.bookmarks.splice(n,1))t.$Message.error("删除失败")}(this,t)}}};var C={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Dropdown",{attrs:{placement:"bottom-end",trigger:"click",transfer:""},on:{"on-click":t.clickBookmark}},[n("AppBtn",{attrs:{icon:"bookmark"}}),t._v(" "),n("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[n("DropdownItem",{key:"newMarkKey",staticClass:"bookmark-item",staticStyle:{"text-align":"center"},attrs:{name:"newMark"}},[n("Icon",{attrs:{type:"android-add"}}),t._v(" 添加书签")],1),t._v(" "),t._l(t.bookmarks,function(e){return n("DropdownItem",{key:e.index,staticClass:"bookmark-item",attrs:{divided:"",name:e.id}},[n("div",{staticClass:"bookmark-hdr"},[n("div",{staticClass:"bookmark-title"},[t._v("章节："+t._s(e.captionTitle))]),t._v(" "),n("div",{on:{click:function(n){n.stopPropagation(),t.delBookMark(e.id)}}},[n("Icon",{staticClass:"bookmark-close-btn",attrs:{type:"close-circled",size:"15"}})],1)]),t._v(" "),n("p",[t._v("位置："+t._s((100*e.percent).toFixed(2))+"%")]),t._v(" "),n("p",[t._v("创建时间："+t._s(e.saveTimeStr))])])})],2)],1)},staticRenderFns:[]};var b=n("VU/8")(k,C,!1,function(t){n("GdVx")},"data-v-7a879914",null).exports,_={props:["relDir","file"],methods:{hdrMoreHandler:function(t){console.log("hdrMoreHandler: "+t);switch(t){case"bookInfo":!function(t){if(console.log("showBookInfo"),t.fileInfo)return void v.showBookInfoModal(t);v.fetchBookInfo(t,t.relDir,t.file)}(this);break;case"help":console.log("showHelp");break;case"about":!function(t){console.log("showAbout"),t.$Modal.info({title:"Athena TXT Reader",content:"<a href='https://github.com/Lt0/txt-web' target='_blank'>https://github.com/Lt0/txt-web</a>",closable:!0})}(this);break;case"download":v.downloadBook(this.relDir,this.file);break;default:console.log("unknow name: "+t)}}}};var T={render:function(){var t=this.$createElement,e=this._self._c||t;return e("Dropdown",{attrs:{placement:"bottom-end",trigger:"click"},on:{"on-click":this.hdrMoreHandler}},[e("AppBtn",{attrs:{icon:"ios-more"}}),this._v(" "),e("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[e("DropdownItem",{attrs:{name:"bookInfo"}},[this._v("书籍信息")]),this._v(" "),e("DropdownItem",{attrs:{name:"download"}},[this._v("下    载")]),this._v(" "),e("DropdownItem",{attrs:{name:"about"}},[this._v("关    于")])],1)],1)},staticRenderFns:[]};var B=n("VU/8")(_,T,!1,function(t){n("pyn6")},"data-v-3f5fdc0e",null).exports,P={props:["relDir","file","caption"],data:function(){return{catalogs:null}},created:function(){this.fetchCatalogs()},methods:{fetchCatalogs:function(){v.fetchCatalogs(this,this.relDir,this.file)},goCaption:function(t){console.log("goCaption in HdrCatalogs component: "+t),this.$emit("goCaptionByCatalog",t)}}},x={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Dropdown",{staticClass:"app-caption-list",attrs:{id:"captions",placement:"bottom-end",trigger:"click",transfer:""},on:{"on-click":t.goCaption}},[n("AppBtn",{attrs:{icon:"navicon-round"}}),t._v(" "),n("DropdownMenu",{attrs:{slot:"list"},slot:"list"},t._l(t.catalogs,function(e){return n("DropdownItem",{key:e.index,staticClass:"app-caption-list-item",attrs:{name:e.name}},[t._v(t._s(e.text))])}))],1)},staticRenderFns:[]};var H=n("VU/8")(P,x,!1,function(t){n("sknL")},"data-v-37d3516e",null).exports,S={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"set-item"},[n("div",{domProps:{innerHTML:t._s(t.title)}}),t._v(" "),n("div",{staticClass:"slider app-btn-gutter-l"},[n("Slider",{attrs:{value:t.value,"show-input":"",min:t.min,max:t.max},on:{input:t.input,"on-input":t.slide,"on-change":t.slideEnd}})],1),t._v(" "),n("Tooltip",{attrs:{placement:"top",content:t.btnTips}},[n("Button",{staticClass:"app-btn-gutter-l",attrs:{type:"ghost"},on:{click:t.clickBtn}},[t._v("\n            默认\n        ")])],1)],1)},staticRenderFns:[]};var w=n("VU/8")({props:["title","value","min","max","btnTips"],methods:{input:function(t){this.$emit("input",t)},slide:function(t){this.$emit("slide",t)},slideEnd:function(t){this.$emit("slideEnd",t)},clickBtn:function(t){this.$emit("clickBtn",t)}}},S,!1,function(t){n("hTav")},"data-v-c75b2ff4",null).exports,M=(n("Pme0"),{model:{prop:"conf",event:"changeConf"},props:{conf:Object},components:{SetSlideItem:w},data:function(){return{setVisible:!1,colors:v.colors,fontList:v.fontList,basePageWidth:v.basePageWidth,defaultTheme:d()({},v.defaultTheme)}},beforeCreate:function(){v.getUserConf(this)},methods:{resetAllColors:function(){var t=d()({},this.conf);t.theme.fontColor=this.defaultTheme.fontColor,t.theme.fontBg=this.defaultTheme.fontBg,t.theme.bg=this.defaultTheme.bg,t.theme.hdrBg=this.defaultTheme.hdrBg,this.setEvHandler(t)},setFontColor:function(t){var e=d()({},this.conf);e.theme.fontColor=t,this.setEvHandler(e)},setFontBg:function(t){var e=d()({},this.conf);e.theme.fontBg=t,this.setEvHandler(e)},setBg:function(t){var e=d()({},this.conf);e.theme.bg=t,this.setEvHandler(e)},setHdrBg:function(t){var e=d()({},this.conf);e.theme.hdrBg=t,this.setEvHandler(e)},setFont:function(t){var e=d()({},this.conf);e.theme.font=t,this.setEvHandler(e)},resetFont:function(t){var e=d()({},this.conf);e.theme.font=this.defaultTheme.font,this.setEvHandler(e)},setFontSize:function(t){var e=d()({},this.conf);e.theme.fontSize=t,this.$emit("changeConf",e)},resetFontSize:function(t){var e=d()({},this.conf);e.theme.fontSize=this.defaultTheme.fontSize,this.setEvHandler(e)},setLetterSpacing:function(t){var e=d()({},this.conf);e.theme.letterSpacing=t,this.$emit("changeConf",e)},resetLetterSpacing:function(t){var e=d()({},this.conf);e.theme.letterSpacing=this.defaultTheme.letterSpacing,this.setEvHandler(e)},setLineHeight:function(t){var e=d()({},this.conf);e.theme.lineHeight=t,this.$emit("changeConf",e)},resetLineHeight:function(t){var e=d()({},this.conf);e.theme.lineHeight=this.defaultTheme.lineHeight,this.setEvHandler(e)},setHPadding:function(t){var e=d()({},this.conf);e.theme.hPadding=t,this.$emit("changeConf",e)},resetHPadding:function(t){var e=d()({},this.conf);e.theme.hPadding=this.defaultTheme.hPadding,this.setEvHandler(e)},setVPadding:function(t){var e=d()({},this.conf);e.theme.vPadding=t,this.$emit("changeConf",e)},resetVPadding:function(t){var e=d()({},this.conf);e.theme.vPadding=this.defaultTheme.vPadding,this.setEvHandler(e)},setPageWidth:function(t){var e=d()({},this.conf);e.theme.pageWidth=t,this.$emit("changeConf",e)},resetPageWidth:function(t){var e=d()({},this.conf);e.theme.pageWidth=this.defaultTheme.pageWidth,this.setEvHandler(e)},addTheme:function(){var t=d()({},this.conf.theme),e=new v.themeListItem(this.conf.themeList.length+1,t),n=new v.userConf(d()({},t),this.conf.themeList.concat(e));this.setEvHandler(n)},delTheme:function(t){console.log("delTheme: "+t.name);for(var e=JSON.parse(l()(this.conf.themeList)),n=!1,o=0;o<e.length;o++)if(t.name==e[o].name){e.splice(o,1),n=!0;break}if(n){var i=new v.userConf(this.conf.theme,e);this.setEvHandler(i)}else this.$Modal.error({title:"删除主题出错",content:"找不到主题"})},useTheme:function(t){var e=new v.userConf(d()({},t.theme),this.conf.themeList);this.setEvHandler(e)},resetUserConf:function(){var t=new v.userConf(d()({},v.defaultTheme),JSON.parse(l()(v.themeList)));this.setEvHandler(t)},setEvHandler:function(t){console.log("setEvHandler"),v.saveUserConf(this,t),this.$emit("changeConf",t)}}}),y={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Dropdown",{attrs:{id:"setting",placement:"bottom-end",trigger:"custom",transfer:"",visible:t.setVisible}},[n("AppBtn",{attrs:{icon:"ios-gear"},on:{click:function(e){t.setVisible=!t.setVisible}}}),t._v(" "),n("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[n("div",{attrs:{id:"setArea"}},[n("div",{staticClass:"set-group",attrs:{id:"set-color"}},[n("div",{staticClass:"set-title"},[t._v("\r\n                    颜色设置\r\n                    "),n("Tooltip",{attrs:{content:"使用默认主题色"}},[n("Button",{staticClass:"app-btn-gutter-l",attrs:{type:"ghost",size:"small"},on:{click:t.resetAllColors}},[t._v("\r\n                            默认\r\n                        ")])],1)],1),t._v(" "),n("div",{staticClass:"set-item"},[n("div",[t._v("文字: "),n("ColorPicker",{attrs:{value:t.conf.theme.fontColor,colors:t.colors,size:"small"},on:{"on-change":t.setFontColor}})],1),t._v(" "),n("div",{staticClass:"app-btn-gutter-l"},[t._v("纸张: "),n("ColorPicker",{attrs:{value:t.conf.theme.fontBg,colors:t.colors,size:"small"},on:{"on-change":t.setFontBg}})],1),t._v(" "),n("div",{staticClass:"app-btn-gutter-l"},[t._v("背景: "),n("ColorPicker",{attrs:{value:t.conf.theme.bg,colors:t.colors,size:"small"},on:{"on-change":t.setBg}})],1),t._v(" "),n("div",{staticClass:"app-btn-gutter-l"},[t._v("页首: "),n("ColorPicker",{attrs:{value:t.conf.theme.hdrBg,colors:t.colors,size:"small"},on:{"on-change":t.setHdrBg}})],1)])]),t._v(" "),n("div",{staticClass:"set-group",attrs:{id:"set-font"}},[n("div",{staticClass:"set-title"},[t._v("字体设置")]),t._v("字体\r\n                "),n("Tooltip",{attrs:{placement:"top",content:"首次设置需要下载字体"}},[n("Select",{staticClass:"app-btn-gutter-l",staticStyle:{width:"180px"},attrs:{value:t.conf.theme.font,placeholder:"conf.theme.font",size:"small",filterable:""},on:{"on-change":t.setFont}},t._l(t.fontList,function(e){return n("Option",{key:e.index,attrs:{value:e.font}},[n("span",[t._v(t._s(e.name))]),t._v(" "),n("span",{staticStyle:{float:"right",color:"#ccc"}},[t._v(t._s(e.size))])])}))],1),t._v(" "),n("Tooltip",{attrs:{content:"使用浏览器默认字体"}},[n("Button",{staticClass:"app-btn-gutter-l",attrs:{type:"ghost",size:"small"},on:{click:t.resetFont}},[t._v("默认")])],1),t._v(" "),n("SetSlideItem",{attrs:{title:"字体大小",value:t.conf.theme.fontSize,max:300,btnTips:"应用的默认值"},on:{slide:t.setFontSize,slideEnd:function(e){t.setEvHandler(t.conf)},clickBtn:t.resetFontSize}})],1),t._v(" "),n("div",{staticClass:"set-group",attrs:{id:"set-gutter"}},[n("SetSlideItem",{attrs:{title:"文字间隔",value:t.conf.theme.letterSpacing,min:-2,max:20,btnTips:"应用的默认值"},on:{slide:t.setLetterSpacing,slideEnd:function(e){t.setEvHandler(t.conf)},clickBtn:t.resetLetterSpacing}}),t._v(" "),n("SetSlideItem",{attrs:{title:"行&ensp;间&ensp;距",value:t.conf.theme.lineHeight,max:500,btnTips:"应用的默认值"},on:{slide:t.setLineHeight,slideEnd:function(e){t.setEvHandler(t.conf)},clickBtn:t.resetLineHeight}}),t._v(" "),n("SetSlideItem",{attrs:{title:"上下边距",value:t.conf.theme.hPadding,max:300,btnTips:"应用的默认值"},on:{slide:t.setHPadding,slideEnd:function(e){t.setEvHandler(t.conf)},clickBtn:t.resetHPadding}}),t._v(" "),n("SetSlideItem",{attrs:{title:"左右边距",value:t.conf.theme.vPadding,max:300,btnTips:"应用的默认值"},on:{slide:t.setVPadding,slideEnd:function(e){t.setEvHandler(t.conf)},clickBtn:t.resetVPadding}}),t._v(" "),n("SetSlideItem",{attrs:{title:"纸张大小",value:t.conf.theme.pageWidth,max:500,btnTips:"应用的默认值"},on:{slide:t.setPageWidth,slideEnd:function(e){t.setEvHandler(t.conf)},clickBtn:t.resetPageWidth}})],1),t._v(" "),n("div",{staticClass:"set-group",attrs:{id:"set-theme"}},[n("div",{staticClass:"set-title"},[t._v("主题设置")]),t._v(" "),n("div",{staticClass:"theme-list"},t._l(t.conf.themeList,function(e){return n("div",{key:e.index,staticClass:"theme-item",style:{background:e.theme.bg,color:e.theme.fontColor},on:{click:function(n){t.useTheme(e)}}},[n("div",{staticClass:"theme-close-container"},[n("Tooltip",{attrs:{placement:"top",content:"彻底删除主题"}},[n("div",{on:{click:function(n){n.stopPropagation(),t.delTheme(e)}}},[n("Icon",{staticClass:"theme-close-btn",attrs:{type:"close-circled",size:"15"}})],1)])],1),t._v(" "),n("div",{staticClass:"theme-item-content"},[n("div",{staticClass:"theme-text",style:{background:e.theme.fontBg,padding:"10px",width:"80%",textAlign:"center"}},[t._v(t._s(e.name))])])])}))]),t._v(" "),n("div",{staticStyle:{"text-align":"right",margin:"10px 0px 20px 0px"}},[n("Tooltip",{attrs:{placement:"top",content:"保存当前的配置为新主题"}},[n("Button",{staticClass:"app-btn-gutter-l",attrs:{type:"ghost"},on:{click:t.addTheme}},[t._v("保存为主题")])],1),t._v(" "),n("Tooltip",{attrs:{placement:"top",content:"恢复本地配置为应用默认配置"}},[n("Button",{staticClass:"app-btn-gutter-l",attrs:{type:"ghost"},on:{click:t.resetUserConf}},[t._v("重置")])],1),t._v(" "),n("Button",{staticClass:"app-btn-gutter-l",attrs:{type:"primary"},on:{click:function(e){t.setVisible=!1}}},[t._v("关闭")])],1)])])],1)},staticRenderFns:[]};var E=n("VU/8")(M,y,!1,function(t){n("LAvd")},"data-v-0d7305a1",null).exports,$={props:["relDir","file","caption","catalogs","conf"],data:function(){return{captionTitle:null,content:null,basePageWidth:v.basePageWidth}},created:function(){!function(t){console.log("getReadPosition for "+t.relDir+t.file);var e="readPosition-"+t.relDir+t.file;if(t.readPosition=JSON.parse(localStorage.getItem(e)),!t.readPosition){console.log("no saved readPosition for this file, create.");var n=t.caption;t.readPosition=new v.ReadPosition(t.relDir+t.file,n,t.captionTitle,0,0,Date()),console.log("created readPosition: "+l()(t.readPosition))}}(this),v.bus.$on("goBookmarkEv",this.goBookmarkEvHandler)},mounted:function(){var t;this.goCaption(this.readPosition.caption),this.fetchContent(this.readPosition.caption),t=this,console.log("registkeyupHandler"),document.onkeyup=function(e){switch(console.log("registkeyupHandler"),e.keyCode){case 37:t.goPrev();break;case 39:t.goNext()}},function(t){console.log("registScrollHandler"),document.getElementById("main").onscroll=function(){I(t)}}(this)},watch:{caption:function(){this.fetchContent(this.caption)},catalogs:function(){this.captionTitle=this.getCaptionTitleCur()},content:function(){console.log("content changed"),this.captionTitle=this.getCaptionTitleCur(),this.$nextTick(this.setReadPositionScroll),this.$nextTick(this.saveReadPosition)},captionTitle:function(){this.$emit("updateContentEv",this.captionTitle)}},methods:{goCaption:function(t){v.goCaption(this,this.relDir,this.file,t)},fetchContent:function(t){v.fetchCaptionContent(this,this.relDir,this.file,t)},getCaptionTitleCur:function(){return v.getCaptionTitleCur(this)},saveReadPosition:function(){I(this)},setReadPositionScroll:function(){v.setReadPositionScroll(this)},goBookmarkEvHandler:function(t){this.readPosition=t,this.caption!=t.caption?(console.log("goBookmark: NOT in bookmark's caption, goCaption"),this.goCaption(t.caption)):(console.log("goBookmark: in bookmark's caption, set position directly"),v.setReadPositionScroll(this))}}};function I(t){v.updateReadPosition(t,t.readPosition),localStorage.setItem(t.readPosition.key,l()(t.readPosition))}var L={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:{background:t.conf.theme.fontBg,color:t.conf.theme.fontColor,fontSize:t.conf.theme.fontSize+"%",lineHeight:t.conf.theme.lineHeight+"%",letterSpacing:t.conf.theme.letterSpacing+"px",paddingLeft:t.conf.theme.vPadding+"px",paddingRight:t.conf.theme.vPadding+"px",paddingTop:t.conf.theme.hPadding+"px",paddingBottom:t.conf.theme.hPadding+"px",width:t.conf.theme.pageWidth*t.basePageWidth+"px"}},[n("h2",{attrs:{id:"caption-title"}},[t._v(t._s(t.captionTitle))]),t._v(" "),n("p",{attrs:{id:"content"}},[t._v(t._s(t.content))])])},staticRenderFns:[]};var D=n("VU/8")($,L,!1,function(t){n("cdcx")},"data-v-bfbcbdfc",null).exports,z=new v.userConf(d()({},v.defaultTheme),JSON.parse(l()(v.themeList))),U={components:{HdrMore:B,HdrCatalogs:H,HdrBookmarks:b,HdrSet:E,Content:D},data:function(){return{path:this.$route.params.path,fileInfo:null,catalogs:null,captionTitle:null,loading:!0,conf:z,bookInfoModal:!1,readPosition:null}},computed:{relDir:function(){if(!this.$route.params.path)return"/";var t=this.$route.params.path.split("/");if(t.length<3)return"/";for(var e=t.slice(0,t.length-2),n="/",o=0;o<e.length;o++)n+=e[o]+"/";return n},file:function(){if(!this.$route.params.path)return null;var t=this.$route.params.path.split("/");return 0==t.length?null:1==t.length?this.path:t[t.length-2]},caption:function(){if(!this.$route.params.path)return null;var t=this.$route.params.path.split("/");return t.length<2?null:t[t.length-1]}},created:function(){},mounted:function(){},watch:{$route:function(t,e){}},methods:{recvCatalogs:function(t){this.catalogs=t},goCaption:function(t){v.goCaption(this,this.relDir,this.file,t)},replaceCaption:function(t){console.log("replaceCaption");var e="/read/"+this.relDir+"/"+this.file+"/"+t;console.log("replaceCaption: "+e),this.$router.replace({path:e})},updateContentEvHandler:function(t){this.captionTitle=t},goPrev:function(){!function(t){var e=t.caption.replace(/.txt$/,""),n=parseInt(e)-1;if(n<1)return;var o=n+".txt";t.goCaption(o)}(this)},goNext:function(){!function(t){var e=t.caption.replace(/.txt$/,""),n=parseInt(e)+1;if(n-1>=t.catalogs.length)return;var o=n+".txt";t.goCaption(o)}(this)}}};var R={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:{background:t.conf.theme.bg,fontFamily:t.conf.theme.font},attrs:{id:"layout"}},[n("div",{style:{background:t.conf.theme.hdrBg},attrs:{id:"hdr"}},[n("div",{attrs:{id:"hdr-container"}},[n("div",{attrs:{id:"hdr-left"}},[t._v(t._s(t.captionTitle))]),t._v(" "),n("div",{attrs:{id:"hdr-center"}}),t._v(" "),n("div",{attrs:{id:"hdr-right"}},[n("HdrBookmarks",{staticClass:"app-btn-gutter-l",attrs:{relDir:t.relDir,file:t.file,caption:t.caption,captionTitle:t.captionTitle}}),t._v(" "),n("HdrCatalogs",{staticClass:"app-btn-gutter-l",attrs:{relDir:t.relDir,file:t.file,caption:t.caption},on:{goCaptionByCatalog:t.goCaption,sendCatalogs:t.recvCatalogs}}),t._v(" "),n("HdrSet",{staticClass:"app-btn-gutter-l",model:{value:t.conf,callback:function(e){t.conf=e},expression:"conf"}}),t._v(" "),n("HdrMore",{staticClass:"app-btn-gutter-l",attrs:{relDir:t.relDir,file:t.file}})],1)])]),t._v(" "),n("div",{attrs:{id:"main"},nativeOn:{scroll:function(e){return t.saveReadPosition(e)}}},[n("div",{attrs:{id:"main-layout"}},[n("div",{attrs:{id:"left"},on:{click:t.goPrev}},[n("AppBtn",{attrs:{id:"goPrev",icon:"ios-arrow-back"}})],1),t._v(" "),n("div",{attrs:{id:"center"}},[n("Content",{attrs:{relDir:t.relDir,file:t.file,caption:t.caption,conf:t.conf,catalogs:t.catalogs},on:{updateContentEv:t.updateContentEvHandler}}),t._v(" "),n("Footer",{staticClass:"layout-footer-center footer",style:{background:"transparent"}},[t._v("2018 © lightimehpq@gmail.com")])],1),t._v(" "),n("div",{attrs:{id:"right"},on:{click:t.goNext}},[n("AppBtn",{attrs:{id:"goNext",icon:"ios-arrow-forward"}})],1)])])])},staticRenderFns:[]};var F=n("VU/8")(U,R,!1,function(t){n("MyDj")},"data-v-b6373520",null).exports,W={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("Spin",{attrs:{fix:""}},[e("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"load-c",size:"18"}}),this._v(" "),e("div",[this._v("Loading...")])],1)],1)},staticRenderFns:[]};var V=n("VU/8")({name:"Loading",data:function(){return{}}},W,!1,function(t){n("Zmva")},"data-v-f02419ae",null).exports;o.default.use(s.a);var A=new s.a({routes:[{path:"/read/:path*",name:"Layout",component:F},{path:"/loading",name:"Loading",component:V}],scrollBehavior:function(t,e,n){if(!n)return{x:0,y:0}}}),N=n("BTaQ"),q=n.n(N),j=(n("+skl"),n("+nFJ"),n("DgNL"),{render:function(){var t=this.$createElement;return(this._self._c||t)("Button",{staticClass:"app-btn",attrs:{type:"ghost",shape:"circle",icon:this.icon},on:{click:this.click}})},staticRenderFns:[]}),O=n("VU/8")({props:["icon"],methods:{click:function(t){this.$emit("click",t)}}},j,!1,null,null,null).exports;o.default.component("AppBtn",O),o.default.config.productionTip=!1,o.default.use(q.a),v.bus=new o.default,new o.default({el:"#app",router:A,components:{App:a},template:"<App/>"})},Pme0:function(t,e){function n(t,e){this.name=t,this.theme=e}var o={hdrBg:"#EFF3F6",bg:"#f5f7f9",fontBg:"#fff",fontColor:"#495060",font:"",fontSize:120,lineHeight:200,vPadding:50,hPadding:50,letterSpacing:0,pageWidth:100},i={hdrBg:"#191919",bg:"#161616",fontBg:"#1c1c1c",fontColor:"#7b7a7a",font:"dongqingheiti",fontSize:135,lineHeight:188,vPadding:50,hPadding:50,letterSpacing:1,pageWidth:100},a={hdrBg:"#d8c09b",bg:"#e9dec7",fontBg:"#e2cca9",fontColor:"#4f3f25",font:"siyuanheiti-Regular",fontSize:120,lineHeight:200,vPadding:50,hPadding:50,letterSpacing:0,pageWidth:100},s={hdrBg:"#e7f2d2",bg:"#eff7df",fontBg:"#eaf5d5",fontColor:"#5f684d",font:"dongqingheiti",fontSize:120,lineHeight:200,vPadding:50,hPadding:50,letterSpacing:0,pageWidth:100},r={hdrBg:"#ffe3e0",bg:"#ffebe9",fontBg:"#fee2df",fontColor:"#523635",font:"xiliangshaonv",fontSize:135,lineHeight:200,vPadding:50,hPadding:50,letterSpacing:0,pageWidth:100};e.fontList=[{name:"冬青黑体",font:"dongqingheiti",size:"7.5M"},{name:"苹方常规简体",font:"pingfangchangguijianti",size:"5.4M"},{name:"苹方极细简体",font:"pingfangjixijianti",size:"4.9M"},{name:"方正黑简体",font:"fangzhengheijianti",size:"1.2M"},{name:"思源黑体",font:"siyuanheiti-Regular",size:"12M"},{name:"思源黑体-Thin",font:"siyuanheiti-Thin",size:"9.4M"},{name:"思源黑体-Bold",font:"siyuanheiti-Bold",size:"12M"},{name:"文泉正黑",font:"wenquanzhenghei",size:"5.2M"},{name:"文泉微米黑",font:"wenquanweimihei",size:"1.4M"},{name:"旗黑修长",font:"qiheixiuchang",size:"4.8M"},{name:"方正仿宋简体",font:"fangzhengfangsongjianti",size:"1.5M"},{name:"方正书宋简体",font:"fangzhengshusongjianti",size:"1.2M"},{name:"华康少女",font:"huakangshaonv",size:"1.7M"},{name:"西凉少女",font:"xiliangshaonv",size:"9.3M"},{name:"青柠幼圆",font:"qingningyouyuan",size:"2.0M"},{name:"字酷堂黄楷体",font:"zikutanghuangkaiti",size:"1.1M"}];var l=new n("Default",o),c=new n("Dark",i),d=new n("Yellow",a),f=new n("Green",s),h=[l,new n("Pink",r),f,d,c];e.theme=function(t,e,n,o,i,a,s,r,l,c,d){this.hdrBg=t,this.bg=e,this.fontBg=n,this.fontColor=o,this.font=i,this.fontSize=a,this.lineHeight=s,this.vPadding=r,this.hPadding=l,this.latterSpacing=c,this.pageWidth=d},e.defaultTheme=o,e.darkTheme=i,e.yelloTheme=a,e.greenTheme=s,e.pinkTheme=r,e.themeList=h,e.themeListItem=n,e.colors=["#1c2438","#495060","#80848f","#bbbec4","#dddee1","#e9eaec","#f8f8f9","#EFF3F6","#f5f7f9","#fff"],e.basePageWidth=8},SELZ:function(t,e,n){var o=n("mtWM"),i=n("cWHa");function a(t){return function(t,e){var n=e.replace(/.txt$/,"");if(!t.catalogs)return;var o=t.catalogs[parseInt(n)-1].text;return o=o.replace(/^.*: /,"")}(t,t.caption)}function s(t){var e="字数："+t.fileInfo.Words;e+="<br><br>章节："+t.fileInfo.Chapters,e+="<br><br>修改时间："+t.fileInfo.ModTime,t.$Modal.info({title:t.fileInfo.Name,content:e,closable:!0})}e.getCaptionTitleCur=a,e.ReadPosition=function(t,e,n,o,i,a){this.key="readPosition-"+t,this.id=Date().toString(),this.file=t,this.caption=e,this.captionTitle=n,this.scrollTop=o,this.scrollMax=i,this.saveTime=a,this.percent=o/i},e.updateReadPosition=function(t,e){var n=e,o=document.getElementById("main"),i=t.caption;return n.caption=i,n.captionTitle=t.captionTitle,n.scrollTop=o.scrollTop,n.scrollMax=o.scrollTopMax?o.scrollTopMax:o.scrollHeight-o.clientHeight,n.saveTime=new Date,n.saveTimeStr=n.saveTime.toLocaleDateString()+n.saveTime.toLocaleTimeString(),n.percent=(n.scrollTop/n.scrollMax).toFixed(2),n},e.setReadPositionScroll=function(t){var e=t.caption,n=void 0;n=t.readPosition.caption==e?t.readPosition.scrollTop:0;var o=document.getElementById("main");console.log("setReadPositionScroll: "+n),o.scrollTop=n},e.goCaption=function(t,e,n,o){var i="/read/"+e+"/"+n+"/"+o;console.log("goCaption: "+i),t.$router.push({path:o})},e.fetchCaptionContent=function(t,e,n,a){t.$Message.loading({content:"读取正文...",duration:0});var s=i.contentUrl(e,n,a);console.log("fetchCaptionContent: "+s),o.get(s).then(function(e){t.$Message.destroy(),t.content=e.data}).catch(function(e){t.$Message.destroy(),console.log(e);var n="<p>章节文件路径: "+s+"</p>";n+="err: "+e,t.$Modal.error({title:"读取章节出错",content:n})})},e.fetchCatalogs=function(t,e,n){var s=i.catalogUrl(e,n);console.log("HdrCatalogs get catalog: "+s),o.get(s).then(function(e){!function(t,e){var n=t.split("\n");e.catalogs=[];for(var o=0;o<n.length;o++)if(""!=n[o]){var i={name:"",text:""};i.name=o+1+".txt",i.text=o+1+": "+n[o],e.catalogs.push(i)}}(e.data,t),t.captionTitle=a(t);var n=document.getElementsByTagName("title")[0];n.innerHTML=t.file,t.$emit("sendCatalogs",t.catalogs)}).catch(function(t){console.log(t)})},e.fetchBookInfo=function(t,e,n){var a=i.bookInfoUrl(e,n);o.get(a).then(function(e){200==e.status?(console.log(e.data),t.fileInfo=e.data,s(t)):t.$Message.error("获取书籍信息出错: "+e.status)}).catch(function(e){t.$Message.error("获取书籍信息失败: "+e)})},e.showBookInfoModal=s,e.downloadBook=function(t,e){var n=document.createElement("a");n.href=i.downloadBookUrl(t,e),n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)}},Zmva:function(t,e){},cWHa:function(t,e){var n="/static/cache/books/",o="/static/cache/txt/bookmarks/";function i(t,e,o){return i=n+"/"+t+"/"+e+"/"+o}e.getConfUrl="/static/cache/conf/user.conf",e.saveConfUrl="/api/reader/txt/user/conf",e.catalogUrl=function(t,e){return n+t+e+"/catalog.txt"},e.contentUrl=i,e.bookInfoUrl=function(t,e){return infoPath=n+"/"+t+e+"/info.txt"},e.downloadBookUrl=function(t,e){return n+"/"+t+"/"+e+"/clearFile/"+e},e.getBookmarkUrl=function(t,e){return o+encodeURIComponent(t+e)},e.saveBookmarkUrl=function(t,e){return"/api/reader/txt/user/bookmarks?file="+encodeURIComponent(t+e)}},cdcx:function(t,e){},hTav:function(t,e){},kdvC:function(t,e){},pyn6:function(t,e){},sknL:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.82c5e79cbd7f801f9e49.js.map